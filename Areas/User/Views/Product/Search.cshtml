@model List<MyWebApp.Models.Product>
@{
    ViewData["Title"] = "Kết quả tìm kiếm";
    Layout = "~/Areas/User/Views/Shared/_Layout.cshtml";
    var searchTerm = ViewBag.SearchTerm as string ?? "";
}

<div class = "row mb-4">
    <div class = "col-md-12">
        <h2 class = "text-primary fw-bold">🔍 Kết quả tìm kiếm</h2>

        @if (!string.IsNullOrWhiteSpace(searchTerm))
        {
            <p class = "mb-3">
                Đã tìm thấy <strong>@Model.Count</strong> sản phẩm cho từ khóa:
                <span class = "text-danger fw-semibold">"@searchTerm"</span>
            </p>
        }

        @if (Model == null || !Model.Any())
        {
            <div class = "alert alert-warning shadow-sm">
                <i class = "fa fa-info-circle me-2"></i> Không tìm thấy sản phẩm nào phù hợp với từ khóa.
            </div>
        }
    </div>
</div>

@if (Model != null && Model.Any())
{
    <div class = "row row-cols-1 row-cols-md-4 g-4">
        @foreach (var item in Model)
        {
            <div class = "col">
                <div class = "card h-100 shadow-sm border-0 product-card">
                    <a
                        asp-area = "User"
                        asp-controller = "Product"
                        asp-action = "Detail"
                        asp-route-categorySlug = "@item.Category?.Slug"
                        asp-route-brandSlug = "@item.Brand?.Slug"
                        asp-route-productSlug = "@item.Slug"
                    >
                        <img
                            src = "~/img/product/@item.MainImage"
                            class = "card-img-top img-fluid"
                            alt = "@item.Name"
                            style = "height: 220px; object-fit: cover;"
                        />
                    </a>
                    <div class = "card-body d-flex flex-column">
                        <h5 class = "card-title text-dark fw-semibold mb-2">@item.Name</h5>
                        <p class = "card-text text-muted mb-1"><i class = "fa fa-tags me-1"></i> @item.Category?.Name
                        </p>
                        <p class = "card-text text-muted mb-1"><i class = "fa fa-industry me-1"></i> @item.Brand?.Name
                        </p>
                        <p class = "card-text text-muted small mb-3"><i class = "fa fa-calendar-alt me-1"></i> Đăng
                            ngày: @item.CreatedAt.ToString("dd/MM/yyyy")</p>
                        <div class = "mt-auto">
                            <p class = "fw-bold text-danger fs-5 mb-2">@item.Price.ToString("N0") ₫</p>
                            <a
                                asp-area = "User" asp-controller = "Product" asp-action = "Detail"
                                asp-route-categorySlug = "@item.Category?.Slug"
                                asp-route-brandSlug = "@item.Brand?.Slug"
                                asp-route-productSlug = "@item.Slug"
                                class = "btn btn-outline-primary w-100"
                            >
                                <i class = "fa fa-eye me-1"></i> Xem chi tiết
                            </a>
                            <button type = "button" class = "btn btn-success w-100 mt-2 btn-add-to-cart" data-id = "@item.Id">
                                <i class = "fa fa-cart-plus me-1"></i> Thêm vào giỏ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}
